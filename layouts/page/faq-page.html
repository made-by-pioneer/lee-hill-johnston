{{ define "main" }}

<style>
.select-navigation {
    background-image: url("{{ .Params.navigation_image }}")
}
.inner-section-content p {
    padding-bottom: 40px;
    line-height: 1.3;
}
</style>

<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="https://unpkg.com/lunr/lunr.js"></script>
<script>
  var lunrIndex,
    $results,
    documents;

function initLunr() {
  // retrieve the index file
  $.getJSON("/insurance-faqs.json")
    .done(function(index) {
        documents = index;

        lunrIndex = lunr(function(){
          this.ref('href')
          this.field('content')

          this.field("title", {
              boost: 10
          });

          this.field("tags", {
              boost: 5
          });

          documents.forEach(function(doc) {
            try {
              this.add(doc)
            } catch (e) {}
          }, this)
        })
    })
    .fail(function(jqxhr, textStatus, error) {
        var err = textStatus + ", " + error;
        console.error("Error getting Lunr index file:", err);
    });
}

function search(query) {
  return lunrIndex.search(query).map(function(result) {
    return documents.filter(function(page) {
      try {
        console.log(page)
        return page.href === result.ref;
      } catch (e) {
        console.log('whoops')
      }
    })[0];
  });
}

function renderResults(results) {
  if (!results.length) {
    return;
  }

  // show first ten results
  results.slice(0, 10).forEach(function(result) {
    var $result = $("<div class='p-4'>");

    $result.append($("<a>", {
      id: 'searched-' + result.link,
      href: '/faqs/#' + result.link,
      text: result.title
    }));

    $results.append($result);
  });
}

function initUI() {
  $results = $("#results");

  $("#search").keyup(function(){
    // empty previous results
    $results.empty();

    // trigger search when at least two chars provided.
    var query = $(this).val();
    if (query.length < 2) {
      return;
    }

    var results = search(query);

    renderResults(results);
  });
}

initLunr();

$(document).ready(function(){
  initUI();
});

lunrIndex = lunr(function(){
  this.ref('href')
  this.field('content')

  this.field("title", {
      boost: 10
  });

  this.field("tags", {
      boost: 5
  });

  documents.forEach(function(doc) {
    try {
      this.add(doc)
    } catch (e) {}
  }, this)
})
</script>

<div class="flex flex-wrap bg-cover bg-center bg-no-repeat py-12 md:py-20 lg:py-32 select-navigation">
    <div class="relative w-auto max-w-8xl mx-auto">
        <input id="search" class="flex flex-wrap w-64 lg:w-152 h-12 font-canela text-2xl text-color-00594D rounded pl-5" type="text" placeholder="Search FAQs">
        <ul class="absolute flex flex-wrap w-11/12 bg-white font-canela text-lg text-color-00594D rounded" id="results"></ul>
    </div>
</div>

<script>
{{ range (where .Site.Pages "Type" "faqs") }}
$(document).on('click', '#searched-{{ .Title | urlize }}', function() {
  $("#{{ .Title | urlize }} > #accodion-styling").removeClass("hidden");
});
{{ end }}
</script>

<div class="flex flex-wrap max-w-8xl mx-auto pt-12 lg:pt-20 pb-20 lg:px-32 inner-section-content">
    <div class="w-5/6 lg:w-7/12 pb-12 lg:pb-0 xxl:pl-32 lg:pr-20 mx-auto">
        <h1 class="font-canela text-3xl text-color-11594C leading-tight pb-3">Personal Insurance</h1>
        <p class="font-calibre text-base md:text-2xl text-color-262626 pb-8">Insurance doesn’t have to be confusing. We’re here to help make life more enjoyable knowing that we have your trust, insured.</p>
    </div>
    <div class="w-5/6 lg:w-5/12 mx-auto">
        <div class="w-full pt-20 lg:pt-0">
            {{ range where .Site.Pages ".Params.faq_type" "Personal Insurance" }}
            <a id="{{ .Title | urlize }}" class="accordion-item-{{ .Params.faq_type | urlize }}">
                <div class="flex justify-between hover:cursor-pointer accordion-title-row">
                    <div class="z-min1">
                    <h6 class="font-calibre-bold text-2xs md:text-xs text-color-AC8042 tracking-widest2xl pb-2 uppercase">{{ .Params.faq_type }}</h6>
                    <h3 class="font-canela text-2xl text-color-11594C leading-tight pb-2">{{ .Title }}</h3>
                    </div>
                </div>
                <div id="accodion-styling" class="hidden font-calibre text-lg leading-tight accodion-styling accordion-content-{{ .Params.faq_type | urlize }}">
                    {{ .Content | markdownify }}
                </div>
                <div class="pt-6"></div>
            </a>
            {{ end }}

            <script>
                function addClass(el, klass_personalInsurance) {
                    el.classList.add(klass_personalInsurance);
                }
                
                function removeClass(el, klass_personalInsurance) {
                    el.classList.remove(klass_personalInsurance);
                }
                
                const accordionItemspersonalInsurance = document.querySelectorAll('.accordion-item-personal-insurance');
                const accordionContentPanespersonalInsurance = document.querySelectorAll('.accordion-content-personal-insurance');
                
                // Show first by default
                accordionItemspersonalInsurance[0].querySelector('.accordion-content-personal-insurance').classList.remove('hidden');
                
                // Hide each besides the targeted accordion on click
                accordionItemspersonalInsurance.forEach(function(accordion) {
                    // Clicked accordeions clickable target
                    const accordionTitleRow = accordion.firstElementChild;
                
                    accordionTitleRow.addEventListener('click', toggleAccordion);
                    // console.log(accordion.firstElementChild);
                });
                
                function toggleAccordion(e) {
                    accordionContentPanespersonalInsurance.forEach(function(content) {
                    if (content.previousElementSibling === e.target) {
                        removeClass(content, 'hidden');
                        addClass(content.parentElement, 'active');
                    } else {
                        removeClass(content.parentElement, 'active');
                        addClass(content, 'hidden');
                    }
                    });
                }
            </script>
        </div>
    </div>
</div>

<div class="flex flex-wrap max-w-8xl mx-auto pt-12 lg:pt-20 pb-20 lg:px-32 inner-section-content">
    <div class="w-5/6 lg:w-7/12 pb-12 lg:pb-0 xxl:pl-32 lg:pr-20 mx-auto">
        <h1 class="font-canela text-3xl text-color-11594C leading-tight pb-3">Business Insurance</h1>
        <p class="font-calibre text-base md:text-2xl text-color-262626 pb-8">Insurance doesn’t have to be confusing. We’re here to help make life more enjoyable knowing that we have your trust, insured.</p>
    </div>
    <div class="w-5/6 lg:w-5/12 mx-auto">
        <div class="w-full pt-20 lg:pt-0">
            {{ range where .Site.Pages ".Params.faq_type" "Business Insurance" }}
            <a id="{{ .Title | urlize }}" href="#{{ .Title | urlize }}" class="accordion-item-{{ .Params.faq_type | urlize }}">
                <div class="flex justify-between hover:cursor-pointer accordion-title-row">
                    <div class="z-min1">
                    <h6 class="font-calibre-bold text-2xs md:text-xs text-color-AC8042 tracking-widest2xl pb-2 uppercase">{{ .Params.faq_type }}</h6>
                    <h3 class="font-canela text-2xl text-color-11594C leading-tight pb-2">{{ .Title }}</h3>
                    </div>
                </div>
                <div class="hidden font-calibre text-lg leading-tight accordion-content-{{ .Params.faq_type | urlize }}">
                    {{ .Content | markdownify }}
                </div>
                <div class="pt-6"></div>
            </a>
            {{ end }}

            <script>
                function addClass(el, klass_businessInsurance) {
                    el.classList.add(klass_businessInsurance);
                }
                
                function removeClass(el, klass_businessInsurance) {
                    el.classList.remove(klass_businessInsurance);
                }
                
                const accordionItemsbusinessInsurance = document.querySelectorAll('.accordion-item-business-insurance');
                const accordionContentPanesbusinessInsurance = document.querySelectorAll('.accordion-content-business-insurance');
                
                // Show first by default
                accordionItemsbusinessInsurance[0].querySelector('.accordion-content-business-insurance').classList.remove('hidden');
                
                // Hide each besides the targeted accordion on click
                accordionItemsbusinessInsurance.forEach(function(accordion) {
                    // Clicked accordeions clickable target
                    const accordionTitleRow = accordion.firstElementChild;
                
                    accordionTitleRow.addEventListener('click', toggleAccordion);
                    // console.log(accordion.firstElementChild);
                });
                
                function toggleAccordion(e) {
                    accordionContentPanesbusinessInsurance.forEach(function(content) {
                    if (content.previousElementSibling === e.target) {
                        removeClass(content, 'hidden');
                        addClass(content.parentElement, 'active');
                    } else {
                        removeClass(content.parentElement, 'active');
                        addClass(content, 'hidden');
                    }
                    });
                }
            </script>
        </div>
    </div>
</div>

<div class="flex flex-wrap max-w-8xl mx-auto pt-12 lg:pt-20 pb-20 lg:px-32 inner-section-content">
    <div class="w-5/6 lg:w-7/12 pb-12 lg:pb-0 xxl:pl-32 lg:pr-20 mx-auto">
        <h1 class="font-canela text-3xl text-color-11594C leading-tight pb-3">Life Insurance</h1>
        <p class="font-calibre text-base md:text-2xl text-color-262626 pb-8">Insurance doesn’t have to be confusing. We’re here to help make life more enjoyable knowing that we have your trust, insured.</p>
    </div>
    <div class="w-5/6 lg:w-5/12 mx-auto">
        <div class="w-full pt-20 lg:pt-0">
            {{ range where .Site.Pages ".Params.faq_type" "Life Insurance" }}
            <a id="{{ .Title | urlize }}" href="#{{ .Title | urlize }}" class="accordion-item-{{ .Params.faq_type | urlize }}">
                <div class="flex justify-between hover:cursor-pointer accordion-title-row">
                    <div class="z-min1">
                    <h6 class="font-calibre-bold text-2xs md:text-xs text-color-AC8042 tracking-widest2xl pb-2 uppercase">{{ .Params.faq_type }}</h6>
                    <h3 class="font-canela text-2xl text-color-11594C leading-tight pb-2">{{ .Title }}</h3>
                    </div>
                </div>
                <div class="hidden font-calibre text-lg leading-tight accodion-styling accordion-content-{{ .Params.faq_type | urlize }}">
                    {{ .Content | markdownify }}
                </div>
                <div class="pt-6"></div>
            </a>
            {{ end }}

            <script>
                function addClass(el, klass_lifeInsurance) {
                    el.classList.add(klass_lifeInsurance);
                }
                
                function removeClass(el, klass_lifeInsurance) {
                    el.classList.remove(klass_lifeInsurance);
                }
                
                const accordionItemslifeInsurance = document.querySelectorAll('.accordion-item-life-insurance');
                const accordionContentPaneslifeInsurance = document.querySelectorAll('.accordion-content-life-insurance');
                
                // Show first by default
                accordionItemslifeInsurance[0].querySelector('.accordion-content-life-insurance').classList.remove('hidden');
                
                // Hide each besides the targeted accordion on click
                accordionItemslifeInsurance.forEach(function(accordion) {
                    // Clicked accordeions clickable target
                    const accordionTitleRow = accordion.firstElementChild;
                
                    accordionTitleRow.addEventListener('click', toggleAccordion);
                    // console.log(accordion.firstElementChild);
                });
                
                function toggleAccordion(e) {
                    accordionContentPaneslifeInsurance.forEach(function(content) {
                    if (content.previousElementSibling === e.target) {
                        removeClass(content, 'hidden');
                        addClass(content.parentElement, 'active');
                    } else {
                        removeClass(content.parentElement, 'active');
                        addClass(content, 'hidden');
                    }
                    });
                }
            </script>
        </div>
    </div>
</div>

{{ partial "globals/collage-section.html" . }}

{{ end }}